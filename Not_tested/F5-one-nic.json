{"status":{},"contains_secrets":false,"product_version":"2.9.0","spec":{"description":"- Download the image from https:\/\/downloads.f5.com\/ and upload to PC Image Services - (trial available) \"Tested with ver. 14.1.0.2 build 0.0.4\"\n- Configure the ROOT and ADMIN credentials with the desired password (do not change username)\n- F5 Admin URL - Can be found on the Service View of the running application","resources":{"client_attrs":{"19cba2d7_deployment":{"y":110.5,"x":573}},"service_definition_list":[{"singleton":false,"action_list":[{"description":"System action for creating an application","type":"system","critical":false,"runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_service","name":"F5"},"retries":"0","description":"","child_tasks_local_reference_list":[{"kind":"app_task","name":"BigIP_Admin_URL"}],"name":"d8fc6817_dag","attrs":{"edges":[],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]},{"target_any_local_reference":{"kind":"app_service","name":"F5"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"BigIP_Admin_URL","attrs":{"exit_status":[],"script":"#print \"VAR_BIGIP_ADMIN_URL=https:\/\/@@{address}@@:8443\"\n\n#print \"VAR_BIGIP_ADMIN_URL={0}\".format(\"https:\/\/@@{address}@@:8443\")\n\nprint \"VAR_BIGIP_ADMIN_URL={0}\".format(\"jose\")","eval_variables":["VAR_BIGIP_ADMIN_URL"],"eval_scope":"local","type":"","script_type":"static"},"timeout_secs":"0","type":"SET_VARIABLE","variable_list":[]}],"description":"","name":"516919ac_runbook","main_task_local_reference":{"kind":"app_task","name":"d8fc6817_dag"},"variable_list":[]},"name":"action_create"},{"description":"System action for deleting an application. Deletes created VMs as well","type":"system","critical":false,"runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_service","name":"F5"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"0f6c18f9_dag","attrs":{"edges":[],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]}],"description":"","name":"7ec20f89_runbook","main_task_local_reference":{"kind":"app_task","name":"0f6c18f9_dag"},"variable_list":[]},"name":"action_delete"},{"description":"System action for starting an application","type":"system","critical":false,"runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_service","name":"F5"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"6cfa9c7f_dag","attrs":{"edges":[],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]}],"description":"","name":"dadc2c53_runbook","main_task_local_reference":{"kind":"app_task","name":"6cfa9c7f_dag"},"variable_list":[]},"name":"action_start"},{"description":"System action for stopping an application","type":"system","critical":false,"runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_service","name":"F5"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"175daca7_dag","attrs":{"edges":[],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]}],"description":"","name":"e875c9a2_runbook","main_task_local_reference":{"kind":"app_task","name":"175daca7_dag"},"variable_list":[]},"name":"action_stop"},{"description":"System action for restarting an application","type":"system","critical":false,"runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_service","name":"F5"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"33fe5b9d_dag","attrs":{"edges":[],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]}],"description":"","name":"a4b8caf2_runbook","main_task_local_reference":{"kind":"app_task","name":"33fe5b9d_dag"},"variable_list":[]},"name":"action_restart"}],"depends_on_list":[],"name":"F5","port_list":[],"tier":"","variable_list":[{"val_type":"STRING","is_mandatory":false,"description":"","data_type":"BASE","type":"LOCAL","name":"VAR_BIGIP_ADMIN_URL","value":"","label":"","attrs":{"type":""},"is_hidden":false,"options":{"type":"PREDEFINED","choices":[]}}],"description":""}],"substrate_definition_list":[{"description":"","action_list":[],"type":"AHV_VM","name":"F5AHV","readiness_probe":{"connection_type":"SSH","retries":"10","connection_protocol":"","connection_port":22,"address":"@@{platform.status.resources.nic_list[0].ip_endpoint_list[0].ip}@@","delay_secs":"180","disable_readiness_probe":false,"login_credential_local_reference":{"kind":"app_credential","name":"CRED_ROOT"}},"editables":{"create_spec":{"resources":{"nic_list":{},"serial_port_list":{}}}},"os_type":"Linux","create_spec":{"name":"jg-f5-@@{calm_array_index}@@-@@{calm_time}@@","resources":{"nic_list":[{"nic_type":"NORMAL_NIC","ip_endpoint_list":[],"network_function_chain_reference":null,"network_function_nic_type":"INGRESS","mac_address":"","subnet_reference":{"kind":"subnet","type":"","name":"","uuid":"92b02b9e-b316-4503-94fb-a90bf3fede8b"},"type":""}],"serial_port_list":[],"guest_tools":null,"num_vcpus_per_socket":1,"num_sockets":4,"gpu_list":[],"memory_size_mib":6144,"parent_reference":null,"hardware_clock_timezone":"","guest_customization":{"cloud_init":{"meta_data":"","type":"","user_data":"#cloud-config\n\n#000-disable-1nicautoconfig\nruncmd:\n  - \"\/usr\/bin\/setdb provision.1nicautoconfig disable\"\n\nwrite_files:\n\n  - path: \/config\/cloud\/nutanix\/onboard.sh\n    permissions: 0755\n    owner: root:root\n    content: |\n      #!\/bin\/bash\n\n      # Load Functions\n      . \/usr\/lib\/bigstart\/bigip-ready-functions\n      \n      wait_bigip_ready\n\n\n      # Create logs directory\n      mkdir -p \/var\/log\/cloud\/nutanix\n      \n      # Download Onboarding Libs. \n      # Could be pre-packaged or hosted internally\n      curl -o \/config\/cloud\/nutanix\/f5-cloud-libs.tar.gz --silent --fail --retry 20 -L https:\/\/api.github.com\/repos\/F5Networks\/f5-cloud-libs\/tarball\/master\n      tar xvzf \/config\/cloud\/nutanix\/f5-cloud-libs.tar.gz -C \/config\/cloud\/nutanix\/\n      mv \/config\/cloud\/nutanix\/F5Networks-f5-cloud-libs-* \/config\/cloud\/nutanix\/f5-cloud-libs\n      cd \/config\/cloud\/nutanix\/f5-cloud-libs\n      # nohup npm install --production &>> \/var\/log\/cloud\/nutanix\/install.log < \/dev\/null &\n      nohup npm install --production\n      \n      # License \/ Provision\n      f5-rest-node \/config\/cloud\/nutanix\/f5-cloud-libs\/scripts\/onboard.js \\\n      -o  \/var\/log\/cloud\/nutanix\/onboard.log \\\n      --no-reboot \\\n      --host localhost \\\n      --user admin \\\n      --password @@{CRED_ADMIN.secret}@@ \\\n      --update-user \"user:@@{CRED_ADMIN.username}@@,password:@@{CRED_ADMIN.secret}@@,role:admin,shell:tmsh\" \\\n      --set-root-password \"old:default,new:@@{CRED_ROOT.secret}@@\" \\\n      --hostname @@{name}@@.@@{VAR_DOMAIN}@@ \\\n      --global-setting hostname:@@{name}@@.@@{VAR_DOMAIN}@@ \\\n      --port 8443 \\\n      --ntp @@{VAR_NTP_01}@@ \\\n      --ntp @@{VAR_NTP_02}@@ \\\n      --tz @@{VAR_TZ}@@ \\\n      --dns @@{VAR_DNS_01}@@ \\\n      --dns @@{VAR_DNS_02}@@ \\\n      --module ltm:nominal \\\n      --module asm:nominal \\\n      --module avr:nominal \\\n      --license @@{VAR_BIGIP_LICENSE_KEY}@@ \\\n      --ping www.f5.com 30 15 \\\n\n      # NOTES: these images still have default admin\/root accounts \n      tmsh modify auth user admin shell tmsh\n      \n      tmsh save \/sys config\n      \n  - path: \/config\/cloud\/nutanix\/rm_onboard.sh\n    permissions: 0755\n    owner: root:root\n    content: |\n      #!\/bin\/bash\n      \n      PROGNAME=$(basename $0)\n      function error_exit {\n      echo \"${PROGNAME}: ${1:-\"Unknown Error\"}\" 1>&2\n      exit 1\n      }\n      \n      date\n      echo 'starting rm_onboard.sh'\n      \n      declare -a tmsh=()\n      tmsh+=(\"rm \/config\/cloud\/nutanix\/onboard.sh\")\n      \n      for CMD in \"${tmsh[@]}\"\n      do\n        if $CMD;then\n          echo \"command $CMD successfully executed.\"\n        else\n          error_exit \"$LINENO: An error has occurred while executing $CMD. Aborting!\"\n        fi\n      done\n      \n      date\n\n# Special case command required for custom use cases\n# bootcmd:\n\n# NOTE: Commands must be non blocking so long running commands (polling\/waiting for mcpd) should be sent to the background\nruncmd:\n - \/config\/cloud\/nutanix\/onboard.sh &\n - \/config\/cloud\/nutanix\/rm_onboard.sh &"},"type":"","sysprep":null},"power_state":"ON","type":"","account_uuid":"4ad90864-dcc6-47d1-9dfb-9feede5927a5","boot_config":{"boot_device":{"type":"","disk_address":{"type":"","device_index":0,"adapter_type":"PCI"}},"type":"","boot_type":"","mac_address":""},"disk_list":[{"data_source_reference":{"kind":"image","type":"","name":"BIGIP-14.1.0.2-0.0.4","uuid":"324c4d3f-4b64-4b32-aece-a2e254c80ced"},"type":"","disk_size_mib":0,"volume_group_reference":null,"device_properties":{"type":"","disk_address":{"type":"","device_index":0,"adapter_type":"PCI"},"device_type":"DISK"}}]},"availability_zone_reference":null,"backup_policy":null,"type":"","cluster_reference":null,"categories":""},"variable_list":[]}],"credential_definition_list":[{"username":"root","description":"","type":"PASSWORD","secret":{"attrs":{"is_secret_modified":false,"secret_reference":{}}},"name":"CRED_ROOT"},{"username":"admin","description":"","type":"PASSWORD","secret":{"attrs":{"is_secret_modified":false,"secret_reference":{}}},"name":"CRED_ADMIN"}],"package_definition_list":[{"description":"","action_list":[],"type":"DEB","service_local_reference_list":[{"kind":"app_service","name":"F5"}],"name":"PreReq","version":"","options":{"install_runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_package","name":"PreReq"},"retries":"0","description":"","message_list":[],"child_tasks_local_reference_list":[],"name":"6efcdeaf_dag","state":"ACTIVE","attrs":{"edges":[],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]}],"description":"","name":"b26cce39_runbook","state":"ACTIVE","main_task_local_reference":{"kind":"app_task","name":"6efcdeaf_dag"},"message_list":[],"variable_list":[]},"type":"","uninstall_runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_package","name":"PreReq"},"retries":"0","description":"","message_list":[],"child_tasks_local_reference_list":[],"name":"1b503b43_dag","state":"ACTIVE","attrs":{"edges":[],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]}],"description":"","name":"e6882684_runbook","state":"ACTIVE","main_task_local_reference":{"kind":"app_task","name":"1b503b43_dag"},"message_list":[],"variable_list":[]}},"variable_list":[]}],"app_profile_list":[{"deployment_create_list":[{"type":"GREENFIELD","action_list":[],"name":"19cba2d7_deployment","min_replicas":"1","default_replicas":"1","depends_on_list":[],"published_service_local_reference_list":[],"max_replicas":"1","package_local_reference_list":[{"kind":"app_package","name":"PreReq"}],"substrate_local_reference":{"kind":"app_substrate","name":"F5AHV"},"variable_list":[],"description":""}],"description":"","action_list":[],"name":"Default","variable_list":[{"val_type":"STRING","is_mandatory":true,"description":"","data_type":"BASE","type":"LOCAL","name":"VAR_DOMAIN","value":"f5.local","label":"Domain","attrs":{"type":""},"editables":{"value":true},"is_hidden":false,"options":{"type":"PREDEFINED","choices":[]}},{"val_type":"STRING","is_mandatory":true,"description":"You must request this license in advance on https:\/\/downloads.f5.com\/trial\/","data_type":"BASE","type":"SECRET","name":"VAR_BIGIP_LICENSE_KEY","value":"","label":"F5 License Key","attrs":{"is_secret_modified":false,"secret_reference":{},"type":"SECRET"},"editables":{"value":true},"is_hidden":false,"options":{"type":"PREDEFINED","choices":[]}},{"val_type":"STRING","is_mandatory":true,"description":"","data_type":"BASE","type":"LOCAL","name":"VAR_TZ","value":"UTC","label":"Timezone","attrs":{"type":""},"editables":{"value":true},"is_hidden":false,"options":{"type":"PREDEFINED","choices":[]}},{"val_type":"STRING","is_mandatory":true,"description":"","data_type":"BASE","type":"LOCAL","name":"VAR_NTP_01","value":"0.uk.pool.ntp.org","label":"Primary NTP","attrs":{"type":""},"editables":{"value":true},"is_hidden":false,"options":{"type":"PREDEFINED","choices":[]}},{"val_type":"STRING","is_mandatory":true,"description":"","data_type":"BASE","type":"LOCAL","name":"VAR_NTP_02","value":"1.uk.pool.ntp.org","label":"Secondary NTP","attrs":{"type":""},"editables":{"value":true},"is_hidden":false,"options":{"type":"PREDEFINED","choices":[]}},{"val_type":"STRING","is_mandatory":true,"description":"","data_type":"BASE","type":"LOCAL","name":"VAR_DNS_01","value":"8.8.4.4","label":"Primary DNS","attrs":{"type":""},"editables":{"value":true},"is_hidden":false,"options":{"type":"PREDEFINED","choices":[]}},{"val_type":"STRING","is_mandatory":false,"description":"","data_type":"BASE","type":"LOCAL","name":"VAR_DNS_02","value":"8.8.8.8","label":"Secondary DNS","attrs":{"type":""},"editables":{"value":true},"is_hidden":false,"options":{"type":"PREDEFINED","choices":[]}}]}],"published_service_definition_list":[],"default_credential_local_reference":{"kind":"app_credential","name":"CRED_ADMIN"},"type":"USER"},"name":"jg-f5-standalone-1nic"},"api_version":"3.0","metadata":{"last_update_time":"1575495275575679","kind":"blueprint","spec_version":29,"creation_time":"1575483348644281","name":"jg-f5-standalone-1nic"}}